\documentclass[tikz]{standalone}

\input{figures/common/preamble}
\usepackage{minted}
\usepackage{amsmath}
\usepackage{mymacros}

\begin{document}
\begin{tikzpicture}[yscale=-1]

\input{figures/common/ast.tikz}

\node (root) [element] at (0,0) {\pycodemini{loop(p := axes.index())}};
\node (one) [element] at (-5,1.5) {\pycodemini{write(t0, datX[mapA(p)])}};
\node (two) [element] at ($(one.east)+(.2,0)$) {\pycodemini{write(t1, 0)}};
\node (three) [element] at ($(two.east)+(.2,0)$) {\pycodemini{kernel(t0, t1)}};
\node (four) [element] at ($(three.east)+(.2,0)$) {\pycodemini{inc(datY[p], t1)}};

\draw (root) -- (one);
\draw (root) -- (two);
\draw (root) -- (three);
\draw (root) -- (four);

\end{tikzpicture}
\end{document}
